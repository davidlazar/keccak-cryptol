include "keccak.cry";

theorem testsPass: tests == ~zero;

tests = [t00 t01 t02 t03 t04 t05 t06 t07 t08 t09 t10 t11 t12 t13 t14 t15 t16 t17 t18 t19 t20 t21 t22 t23 t24 t25 t26 t27 t28 t29 t30 t31 t32 t33 t34 t35 t36 t37 t38 t39 t40 t41 t42 t43 t44 t45 t46 t47 t48];

// test the bit reordering function
t00 = r `{n=29} 0x53587BC8 == join [1 1 0 0 1 0 1 0 0 0 0 1 1 0 1 0 1 1 0 1 1 1 1 0 1 0 0 1 1];

// short message tests

t01 = SHA_3_224 (r `{n=0} 0x00) == md 0xF71837502BA8E10837BDD8D365ADB85591895602FC552B48B7390ABD;
t02 = SHA_3_224 (r `{n=1} 0x00) == md 0x860E3EC314C5CBF19C1A4314E9EA8CB85CECD18BD850B42F5C6F2A07;
t03 = SHA_3_224 (r `{n=2} 0xC0) == md 0x6B22CDDBD1366F7B8DB2026AEE8A0AFA86B323AED7AA270AD928D1C5;
t04 = SHA_3_224 (r `{n=3} 0xC0) == md 0x2B695A6FD92A2B3F3CE9CFCA617D22C9BB52815DD59A9719B01BAD25;
t05 = SHA_3_224 (r `{n=12} 0x9830) == md 0x548C76FF8FEB36FD7AE767F442F0AF32461A72ECBB70F7624C465BAF; 
t06 = SHA_3_224 (r `{n=123} 0x2CFF7186405B02024C4203A7FE7A11A0) == md 0xF3B0AA53A5361E28E589E24BB45A1B65BD64AA1A294914909317737D;

t07 = SHA_3_256 (r `{n=0} 0x00) == md 0xC5D2460186F7233C927E7DB2DCC703C0E500B653CA82273B7BFAD8045D85A470;
t08 = SHA_3_256 (r `{n=1} 0x00) == md 0xC3E5CB55999EEFF4E07B7EFFEC77582D0A5A11A94FC268A872493099273992E1;
t09 = SHA_3_256 (r `{n=16} 0x41FB) == md 0xA8EACEDA4D47B3281A795AD9E1EA2122B407BAF9AABCB9E18B5717B7873537D2;
t10 = SHA_3_256 (r `{n=17} 0x4FF400) == md 0xFEB2D9EE5DB62E192CC136B0328F1A04732CF5CD4DBE067B5FB35E729D9DE106;
t11 = SHA_3_256 (r `{n=57} 0x8569DF971E674E00) == md 0x9C8553DC980CFD3583275AEF2B2E55DFA63B792A39B112030DFF1615FC5C275D;
t12 = SHA_3_256 (r `{n=72} 0x1F66AB4185ED9B6375) == md 0x9E03F7C9A3D055ECA1D786ED6FB624D93F1CF0AC27F9C2B6C05E509FAC9E7FCA;

t13 = SHA_3_384 (r `{n=0} 0x00) == md 0x2C23146A63A29ACF99E73B88F8C24EAA7DC60AA771780CCC006AFBFA8FE2479B2DD2B21362337441AC12B515911957FF;
t14 = SHA_3_384 (r `{n=1} 0x00) == md 0x4C6D164043571A32E169A527CA3503EA391BF91F22287215DF75EA243D53A0D042BC66EFE2956D8606A24F39E255A081;
t15 = SHA_3_384 (r `{n=8} 0xCC) == md 0x1B84E62A46E5A201861754AF5DC95C4A1A69CAF4A796AE405680161E29572641F5FA1E8641D7958336EE7B11C58F73E9;
t16 = SHA_3_384 (r `{n=15} 0xCBDE) == md 0xA5F1B2C8F5A92A45E5622455B8A1FD1EF26310B180A9D7DB5A3D8413D8ABF140C70C1BDBD91DC5E609042CE88AD9CC9E;
t17 = SHA_3_384 (r `{n=238} 0x5FE7F0B783293004B9D834D71397512B9F807927383B88D996FB32B5D748) == md 0xA30AE38FD9B58A00688CA22AD467FD950FC299132BE95EEEAF27EB2E39378125F0C7DF34FB18C64EDB1B03D4CF8D1B75;
t18 = SHA_3_384 (r `{n=1023} 0x1B4BF91CE5B2317E526F4046E9CB668AECD040B0F445E74A57544BE2A4F8572C5BD363240474BE6E7285B1A094E0F938D927BAF67B26C648A4A2933EECA67B3610210B7D3ABC972A0A6E1698BF2FC8E53E50FF4458C2DC5D581F78CE93A7D5758B3779FE9C169282FBB5BB0FBB84253AF925D1599D63C1216232CDEAD5A6AA6C) == md 0x3D39935CFDF5D2F3485C68535C4DFF9B7FC0E53C7E205D667253A22EF1C4DE0CF7A96473F8AA76A5E3FF0F0DD64DED3F;

t19 = SHA_3_512 (r `{n=0} 0x00) == md 0x0EAB42DE4C3CEB9235FC91ACFFE746B29C29A8C366B7C60E4E67C466F36A4304C00FA9CAF9D87976BA469BCBE06713B435F091EF2769FB160CDAB33D3670680E;
t20 = SHA_3_512 (r `{n=1} 0x00) == md 0x7D9025BB145A0814083E934BAA80EDE67322651DE52062BF9EB93623C37EFC74C62240CF8539107F9210C1E1126F79CBAEDA6B82B4A8CE6821589C403FA76B9A;
t21 = SHA_3_512 (r `{n=24} 0x1F877C) == md 0xEB7F2A98E00AF37D964F7D8C44C1FB6E114D8EE21A7B976AE736539EFDC1E3FE43BECEF5015171E6DA30168CAE99A82C53FA99042774EF982C01626A540F08C0;
t22 = SHA_3_512 (r `{n=64} 0x4A4F202484512526) == md 0xF326C7C126DDC277922760FEEF77C9BAB6FB5D3430F652593703D7C5E30135CD0B0575257509A624184330D6AB1F508A666391B5D4690426B4E05301891DF897;
t23 = SHA_3_512 (r `{n=129} 0xE35A1AC6054BA5FECE64AEB3CB97ACDE00) == md 0x23C92C76935850F95A2E7B81158B9C1AD1DD524468AFC04A63A57A575D52403FF2EB3EA6BC96463C6625D84240683F97A448F40200B05C974C2A574EB278B7BF;
t24 = SHA_3_512 (r `{n=512} 0xE926AE8B0AF6E53176DBFFCC2A6B88C6BD765F939D3D178A9BDE9EF3AA131C61E31C1E42CDFAF4B4DCDE579A37E150EFBEF5555B4C1CB40439D835A724E2FAE7) == md 0xC0A4D8DCA967772DBF6E5508C913E7BEBA1B749A2B1AC963D0676E6F1DCD4EBAA3F909EF87DD849882DC8253347A5F6520B5B9F510973F443976455F923CFCB9;

Keccak_r40c160 M = take(160, Keccak `{r = 40, c = 160} M);

t25 = Keccak_r40c160 (r `{n=0} 0x00) == md 0x1FD48563BD4780FE792537E4D0B1A3BE7D9B367D;
t26 = Keccak_r40c160 (r `{n=15} 0xCBDE) == md 0x81C50382364EB3EEF50F3FCCCBCC8D78680E9A49;
t27 = Keccak_r40c160 (r `{n=48} 0xC6F50BB74E29) == md 0xEC6E563739B7479D2A90071890A78249C19A4D2B;

Keccak_r128c272 M = take(272, Keccak `{r = 128, c = 272} M);

t28 = Keccak_r128c272 (r `{n=0} 0x00) == md 0xA19F1AA74311FFFE325B5157BB761E4633050F6279D3441DA161362319C1581A7175;
t29 = Keccak_r128c272 (r `{n=51} 0x9AF4C2D144E340) == md 0xD8333315585AD7688BA6AEE36EB28AB97DC3D08DCFA78F7BEC83646D5AFEF10028DF;
t30 = Keccak_r128c272 (r `{n=136} 0x82E192E4043DDCD12ECF52969D0F807EED) == md 0x0D819EE326523B7D0195B5EF071991397605FFBCD221E77F2C9D6C2F06A9C23DD1DA;

Keccak_r144c256 M = take(256, Keccak `{r = 144, c = 256} M);

t31 = Keccak_r144c256 (r `{n=0} 0x00) == md 0x31D219791E62BF00E117A0ADFD62917E91146AB04C9D08A7AE123010B9696FD5;
t32 = Keccak_r144c256 (r `{n=6} 0x50) == md 0xD10084E3F5A3CE678A31505F2A89990DF41F6BD73488121FE8FB6D8A3B9CF17D;
t33 = Keccak_r144c256 (r `{n=1003} 0x2CA31ECAE38ECCBDD176B36679ECC7914EDE98BD88D3426589EE92A0BC1CEA705712B3D7CD9DD823A56F22F506966FFE58A2B6E10130B47401A62F67687E4DA182DAAD13226F08784A7DD8C8E1C1005EBC8D631D6A906C1C3EF7846298A9B18826A23F7A88BF20FA80E583A12D3A5A675998D5B561CEC96B9072E4169040) == md 0xF2DF6E07B5BABEB0AAE3EAFB7821C6E240F310BB301C8B165352B7E79B728E8C;

Keccak_r256c544 M = take(544, Keccak `{r = 256, c = 544} M);

t34 = Keccak_r256c544 (r `{n=0} 0x00) == md 0x2507DC4976767ADD735F22C1831FBF323CB9F94755C289A680B327ADFF881FCD5D9B3816314C55AB80881001B833C5BD02E8AC5359B07C27ACDFBB64ABE8738451AA7049;
t35 = Keccak_r256c544 (r `{n=311} 0x9C30ADFA9CE9F25A6AFFCA7105DFBDBFA98A0E2F57719A645C5D867F5B7D5F8A0D821C605102DC) == md 0x3C32FACE07A56BEE9D8633C2CC443C306B5710C4993CD373471DF5617EEE89DE1486C9C91A4CEA1B80C87F8292AF60083549722AF904683B1C593904F4FC421125DA5883;
t36 = Keccak_r256c544 (r `{n=582} 0xDF98AAD16AB9EFA536176798654E6394668F576C9D6DEF29B6085FA29C9878966EFBE223E5F56D5BB69E8B27AC9B23F4D89A856EBA58EC5D20C7EAE6E58102BDD58C57EF843EB5D798) == md 0x441EB33FF83B5CF44C014ECA4AB38522F93366A93BBC85432BEEFBC5BDA814E580DD0D6377D2CFA53F5343F635186E59395AAD60AFEBA97C55FBA6582BB281CF7304D407;

Keccak_r512c288 M = take(512, Keccak `{r = 512, c = 288} M);

t37 = Keccak_r512c288 (r `{n=0} 0x00) == md 0x681C4ECFE190D9625B011BAACED04540C73A1FF62DEF9AEE443DEA516387FBC8E449AF80342F3B0D705A6672BBD4C9E534B28038B2905E54D708715CA2330D79;
t38 = Keccak_r512c288 (r `{n=12} 0x9830) == md 0xAF521AE04B1FCF1C03615ED4631606F812B5EE938A5CF21DDD2FD6D75C0996FA077AA2DF22C482572EC86EBB7A61FA8BF9358F31397C395F1C5D6B02F17DAB88;
t39 = Keccak_r512c288 (r `{n=99} 0xB1BA2223CC3AC042D06554EAC0) == md 0xAB00B53FCC81A60BD530B908B2B4B7F4F2A1F53CD28CEA469AAC16CF6553DEBAE1F6305B6FDF71A227A47502D45F269D63313ABA81C71A577782631DF33F5CC1;

Keccak_r544c256 M = take(544, Keccak `{r = 544, c = 256} M);

t40 = Keccak_r544c256 (r `{n=0} 0x00) == md 0xA3CEA55CFD9F4432AD3F9AE33673AE12665F66D150A11AF54E007C7F26F7C9A6E69862E14A2BAD40048D439E26FB67B40807412BAE2EB42B6896B1D4D602755B23EC19E4;
t41 = Keccak_r544c256 (r `{n=70} 0xF8CB65B7FE6995F200) == md 0x730AD05FCC3DD4E250D00D5426A42BDAEB8615772F1D1BC0F9AE2639F8920A1BF36CE60F893EAFE782095A903848C7B150E79B3AAB32C1C3EDE8AB4E64D4015E5E47021B;
t42 = Keccak_r544c256 (r `{n=237} 0x7F9CAF49ED7EC9CA1693C0D5700965718F7D6C178B7CA4E577F07FE5CBD0) == md 0x3CB46D7E5B09A8EF791CAFE788D6C5648AC9FEDA92235DB923030A2664CCFD2139B52C1B21CA02878AF331B66BDF166B1913F633EBC1912FD173B9E707A6CD67DCDF5A66;

Keccak_r1344c256 M = take(4096, Keccak `{r = 1344, c = 256} M);

t43 = Keccak_r1344c256 (r `{n=0} 0x00) == md 0xBCF56AC882AD981CD0FA74F0F397572C28801C1EB31C1BAC4CA703D6F19E9419D693BA6C2B55EFBF139777FA6BED9421506F9F27D462E7AACFF3202A88CA23895265C9AF63C4B0244CF3311F3F2839D7A86B94C8B951DF8B348C9C46FB6AF99BA560CF8CA75DC0389E1CFA52347D021FF95AFA282A3FC12537CB23F31933F018F48645191F95FD044FAF3822A399C9FF23639DB8E1D31D0B588F4E0607C90D6711724282BC9C7E68470DE2068A4D5F4EE9E78F0161B0DD01D2FCDE5C9E0E046C435B580AE631F8F16163A630EAE06079D72DA0E5CBA9C7DB9B48DAC57BD2D4E9F9328D6545C356CAFB4ED136151D4B45618D232BDA2721CAB30C9F7008ABBD705B3EE0C08EDE7FCBEEB427A5F3852BFF3586E58FDEDE3FE6036CDCB08EA1B1C1C3B7C1549F3E41477245D8686C312D6D9C71EDB983D3B05AA0645A6B797067B3FA1AAA2ED9B039A427396DA679AB245705C2B901EFE220F659FBDD4E7D2B6CE91E18FEAD0BCAE96F3EE021CCF9E6854B6E64BA58029622255B120684B44C6EF22BC9BC8C28C2B322805C38BEAFAC6B39C8A235525F53A057891E8313950D09C03F54865D6C672C6B73486587E4EBC7D84764FDBA4DC4845A2145C3ECB9925181A6DC4580D049553FC8C7E35CFA22688D992B80CD6D92AEC28EA2CE810D2F37B02AB00DAE1940DE8602B98FE36ACC651B502F11346D3233000AF0E0C6041A1BCA;
t44 = Keccak_r1344c256 (r `{n=36} 0x0127A1D340) == md 0xE2ECAAA797727CEAC7CBFCFB45760D16CD080D71F5B581E62BF9840EAFF7F32151C924DE440ADC7424ECE3C9776D007CCC59D1DFF87CE730DCECB056812F5703D3500CA69CCC8AB4D58D64F5B8E67B2E70B9D987123825776CB5E2988B27F06E00BEA60939D34788F54B6F9F2D47B2C67A0CAC02CDA400F19B92013C435D70A3D78EF2DFD762CB0EA1806C62DCD3C4C5E8CB1F7C75FF8FCE24BC0712B437C2916E5CBC182F720164C471CA3F095E2A0A457234AAAFB72EC8D01B6D9B1CDE1DC3CCA6559B166A55F4BCC36992856AE0C265086A20F9EE32AFAB3B8BB2634CA34F2A00DA09828653CBC630D6F1AEBE67E92794231B30CA10054D726BEFF413AAC01B24DE00E0F439078870CF8BDF4F8C83EF113F8C8DFB43FAFB1436549E7A9BA7A68F2BAA5F234BBFBE2255C326C00624C365F845E22E2CD9799DF544318FD2C8D9396AA5777B13D7AC9A8764969B6CF545AA80D95C76723EECAD227FC8F474A093056B73BEB8B2C81B9AE1A2C508EBE41AF5755714652471DED4320AB075C35B40B18DC4DB1574D168EC5E34821BAC1C239330D1F4BF09AD54FA0815BD4CA673545B8FED3685EC3DF5405A78F1A8BD8CA9A800F7CBD86661338B77ACBA5893548949F72DD51536F7A19F81855974549AEE361B460D2460D1BE9032E055664D6D2673333B05386D533DBDA16788B059A3FB76FB40716BECB23DCDCF17C539EE8E;
t45 = Keccak_r1344c256 (r `{n=128} 0x52A608AB21CCDD8A4457A57EDE782176) == md 0x35668B08C9867AE876052F078514165528CF02CF2D99D7ACD6B732EF90AA382B124F5F4ED264F49A876A2529D3A009BEC3C3A2F50E50586C190B37640F3AE22F6F4011CCC4EB8F356903212A5C5B5BAC110CB5EDE7C1E4E87473AEB5C633322F6A62868B07BFA3748A85E2F95D2BF509E2501D74BBAA7897F84C6059C588C40B9CC3EEF499477C2A874881A0770B94DCD4A63840065F39808A929BB248EC1E3556801F26E8CE296FF1D1268311939CD42B356485F39457CFFFB56E95686F44D1280D856E531B78A84A1101DDC3FCFEE5B7734E7ADB56669E475E0F1AFFF90EC4A880950C936AB988B82890BDC7E5D0B86BEE2ED9F729C8CF0DD61C943DAF2EF835D92367EEDE5F594906E77FE0E8D2DF9C38AD14EA87F2BC819422D598F1996311F17D1ABA48F161434928F1B1037400AF60395DDE1ED017154C7C8A8762C1DDA42FAD08DD8553545CF4B7D85BDF3F0AA7F4DEC76EEEAE579FA92847519776C1873FC46E8EE835E2E23A1F46415A7D262DBECF358E2226CB990B19420502899E28D2BE94CD7F69012A41D485B1C6A0BDC5DB14F3CE6DA9038A108538DBCC1EAE2746679F9389B3AE0B92F33AA41EAD46268B5C54BAD1ABA3C8AF85256332732AB659BCCBAAC358E5D6045740B5393B631DB57EDD60A02D728386C3385717F5C5F4A9C9B62D8C995EB11ECE97B3205F454740AC565C579B6659E834803331A55B;


// really long tests

t46 = SHA_3_256 (r `{n=2048} 0x724627916C50338643E6996F07877EAFD96BDF01DA7E991D4155B9BE1295EA7D21C9391F4C4A41C75F77E5D27389253393725F1427F57914B273AB862B9E31DABCE506E558720520D33352D119F699E784F9E548FF91BC35CA147042128709820D69A8287EA3257857615EB0321270E94B84F446942765CE882B191FAEE7E1C87E0F0BD4E0CD8A927703524B559B769CA4ECE1F6DBF313FDCF67C572EC4185C1A88E86EC11B6454B371980020F19633B6B95BD280E4FBCB0161E1A82470320CEC6ECFA25AC73D09F1536F286D3F9DACAFB2CD1D0CE72D64D197F5C7520B3CCB2FD74EB72664BA93853EF41EABF52F015DD591500D018DD162815CC993595B195) == md 0xEA0E416C0F7B4F11E3F00479FDDF954F2539E5E557753BD546F69EE375A5DE29;

t47 = SHA_3_512 (r `{n=5324} 0x0FB99FC3E9AD2E007790D21E15401A9E4C003C0B8F0847B67597ED134422F23D6CA7B6AF09AB6AF77FBFE2D846CCEF40F327795826F01A530A0DD526883FF88AE10427EBDDB4C4BFAD10AA5FA7C618A226C913C52401BBB8DCB1790D86AB9CBC36BEF612D2F6AD589F4AC3748D7E9B450FBA2A2419C6992A34254D4BBE044E807235798CB3761C99F3C059F9EE2DDB4A964B46F5438C65FA704C61D70F4ECBE39F235022396926F3278AA31712672A2E6EA76FC9BCDEAB8F325CF345AB5804B030B3C3871FA9F70F5CC5E2F358F63B91618AB262EAD9BD4311272AADD9B9F4881E51F77BDE02B0D81B21A1C2A743A41085EE70AF70B7C9CC34E4182F9C0EE04A67430A19B3DB7B4E00303D4B8317AEA2EEEB794A4FEFD840FA9C250BF165579FF5FA0C92F5EF1078ED594FB1913E1F486A910120A38FC31A17A60306B6582681ACB8ED12C2C61C8025760B9A5BB1A75AC7EE6F3CAC8DF00D0C7B817DA9AC170373EC38EAAF3D7E0ED02D8349599C3998967C0E41676BBD6F6EB9CF5B8E671402041BA0060AF7441679C80EF68F48BBBB126EF5D19F5027ADF0E4E1ECFCCC5D74C990151D5724DAEF4C2B213930FD743C9D394C5CBA4433B19BEF5298D261C61156C51A48EC33E10BDEAECCC10BB2D2DE13E8BBD0535F50C4B36D5C8AC8E263A4E66E0057F68742BAF003B4B6D7C1767F31DC75E716DA3719FB395AE73CC69056AFA9C0655532688B9B031B868C3D0D2C28B74C059F02899869DB6CC7775D97CCF81D1619CF8B094EB97D250ACC54CD41203F9B966E9A5B1AAC45C14AAB6927570AE21BE493A8DBCB9037B04E348F9B27C72A0995ACDC078DBA1F138DBB43DA12C37157EE7B5F1E1D19C0B1D9C340E646F30CC02424C5F574FAF8572E90948B87C7B280E4097E0024E06B3061ED69655D13A64FEF6FF9AC7B1E80) == md 0xD03DA65002AD745583E7E728ECF9FFC654317BC0EB78ADE0ABD5512DFF5D7F1DB91CFE69A63369D27C9B13E411F3417168768CD944D5CA22FC0C9F4D9B6A0D7F;

t48 = SHA_3_384 (r `{n=26744} 0x1A3DEAFCE70AF6F3F55D66AD9CE78D5F4D5C5F2638A810AFCD07D67E9F9A1380D6B34BE482EF030C22F1E978F544609CCE35A74C5109EE7038495B6210CDBCA8DC82C6E9E7B0D593FAD9665382B3C401AB8941DF71307DD77EBAF140AA66A1F76316478850E58886A9610631E9C722F459FA00C0B53124FB4F12778BBBA3760826D3DBA67CD030A96B654AF93F8E395F5F439549489F8161683F124BC980E6939C83A6085E4B6CAAF8BCD89A0E01ED70DB487166CC29735D9235A9CDC57B80C9C2E591DF6322F5BEDD32937073F781A30389552AE83FBE147D1B3D3461A3DF96C15CD96900C56718EAAE838417057579115936862679F5F2A45DADF65D14108AF1641DF987B57986384FA1433789F5DFBE87E90BD4E9D8D4D0741FCDA7348322B967B566B18612DBB8FE64F151947C3F7E361EE868676BCCD0CB3A1AFE046BE70057A05ADD3E65AF31E3FF414A627C0183E8FF583B41B75B203650420216E6DFCAB289665F054CFE3EA0943647528518573BBB1D0F27E1449E98739EAF0D009432DF0C1EDC1625264B94A71DB762659FF5A3A7A867F182D1F1FD34B341A4A181221870DC4A494013091A7E3B2B07E0160C438F1EE1E8A2B989C4FFEC36B5083EA427606767C29672F44779A8505B422B25A56907F565B27690D011426A62DF0036D57D967CD1D14E915BBC2691E7AF818C769D9E1F9EDD40894BE88FA1D7A5952AFD898E837716ACD73953BF2D1D448123FD1A0276D2C2EBDC760A4B787416CFAE5E963FCBDC8B551CB70F91DA0ED4A8090FEF178E879F2C34F3A269DFFFF09772D44A13D7A17468B5834C460957D5243C325F63F05F89D4ED98D361E7F0AB8A83948A64D0CFF8514841AA21C7F337920A9983E59BE4A0F1339E1E462F92DC1FC070126206012458A499A8111FAE078E00B0CA3BC1D6C7087CD318D5603C1C7E0425E6F729CEECA5F35B82F8A42E0E9B950EFB0904C5FB5C06D91D239913665ED1F1EE4B82185A01BA86CA2D3EA94E5A8842231A94C05280183B7ACA289984103F122203EC2FBA4A382E6F5236D6F68DA05E3BB0C558421F0EFAB91DCEEF6D1ECDC60F9B88F8BEFE31CDC3C2F024A1AF2C7336AA5D151E8CDA814A5FE898BADEB9DD680E337E682EBC22BFAE445417E37D2D89A338659A280AB1206DB74DD42C6F25639C1803BFDF2156DF613B0F5924D209F7F9003CE8794F989F4F27B82121210F4F65EC5A1F7723305CEE438C41F793EE04496BBE337BBD2FD3023830B1C8889C6F4D0C1192E364EDBE1CD987BA5D66224EE9C9405E1DFCEC0EEFFC5C73D3123F6731C6295D1E6B854B884FD22B6A3BBBE5395312585CD138BCA67532C6AB71BEBC6657C50DA87D2AC6068FA3970202C5E15EB7B4B3D2676C0134BCF1EAC2B26BA46930B5E660B16060894884C88BFACD6779276B86F685AB6F17C6D53F621275FAD66D021D26D1D480AFAB4B5EC75E0E763FFC45F599EA02504DA5D91EB5EFC3E4AE196F219E45E7CB05594958C876FF474A020EF73C1F09B1F7F7457E816D3AF51D86663D4D461754CD5E907456691E02446D6CACFD33516206A31870543D574592087773653D4086C2BDCBAB3C9B65CA11AD0D4E58DDDA8B440309989857103929549B7300CED42651D4086661694092C42875CB62858E6D1BE5F7274B4BCD83AA4DA05CACA186A30902830790F9FFA24418E1F9DB00FA40477E83B05C2D11AD7D81DDDB1E31F94A9DD5E9E13391C22479B570976E3AFC1BE41086D3BE6689D87CA4326A7CDE8E5B396A678D3CDB2C80FECFBA2BC799AE8B1528E96D880CD098DDE910D097EAAE660AD4D7EA51C18F18AA1B39614299A172512521DFD231B9840909839EB69C892EE23F1BCEEC1FADBA75786C7DED93BC9983F74CEAB397EB8BA84F7E4130B34258D628594A6F9E2348FD91BA2594E07B8057E8A2AE3ADFEA0EF919555385977041C5B6DC4F3880569171F7217AAA9A85F2F5BBDFE3FFDF79248F2A35FD4DEC34980C67290339B1C0A5A6AB8838157AE2F5140B4A24924A6688AE5CE72A48103EE9029CE8A0F15B1FBB19A12FAAB80A7CD9C0E389FC2775833E3190F1CF735ECDFE7F6B6C326506AA82613CBEDA8DD3691B81F4C1E3B0FC32D7E6719CBFC12F4A26E0FC29D6417953ABC9568DB4ED9A294B9FD5F2A666DDA546ABA301B1C60985033953EFD6F4538333B5C7DD3148814A3FD7927C366F40B3D7ABBDEB2332DDB586AF80959097663CFAB2FEECAD6D368AE10EFF9663D5F8BAB95935D25F45776F7F04B46817D05165A9DD4770509ABB92F8B9E7373CA780703569981754A51D6D376D65C57F55CD70E2DF5FDF5A6B829AE30CE3BF942815C8B4BE858DB58151D02A68AAB9FD373E047EFA51BD1A0CD1B61744D9E97CEBA3334B3BAAFEA3BC9E43AE097CF2C3D713EECC247FF43EC74D54907D8BF45E45B2E0E11D82B126A8179D3F66C055E11F69EA67AACC5FEE8AF01FAA379E51998F5070F9EE0FD30A2EB22A925586FB1B39024EB5EB1E127C76A149E7F02AF1B73C16E9E5A5DBE378E08A9FADF1194C625132AB3FDEFE8FE9A89BB8E0035A1A3AC5278F5D3D0ADE0E41C81C6853A41C4AC45BE3F68180FE23F27F18BE2E339DE1D559D75DE63ADF7A32BAE42B037AEAA3E123A5314891BCD35CA48D57DF4C17540E97202A8EA1328DA25B1FD6BE2B56AEC1E5DEB209F3B7A13ADB1CBE53EB645956E577A7621D74E42376D70BC5C4AACD239A852FBB7B3F62CF59FE10438C1DC8E1E46566325DA0CA43AAA63FB7E0B450A2DB3E3A2204704D894DB24B72B3078106E096CD543DCF027650CB4965E38AC36A8AD588C5962B4E26548AB88F0BC20E10ACC1C3FC00EF415B3C32499264552B14E2C0E789A3B8A8BFF9620FD939D0B34E806177EC696A4B3B1CA4B32BA979B2690CFB3A6B17BCEE6877FFCE757E4116DA01099FFE82ADD5A0C593E73449A96DB9CC2B9E846D166B095174F2CAF8B35DD878C836D9BB6EEEAF8E1BC5D0E149C739828CC480D731DC16B35B80D4AD82ED7D29BD05018239EFECF8DEAE180C6A459DBCBFE4AAB9A5E2C1E1BC31418CF2EEEB31FDF8BA02C9A91525E9163F672BAE2EDEC38C1BDB84EA237B4EF86BF5C0F0FFE178E3761E82D94F66E5EA40BA8170BF768409E1B4177AAFD9937BCE3FBFF590320D7C445372463FBBFB34F57447F42C16E026F179CBF82F617C86D1E8D42F6C908F9C6B77E38D25D51303DBD781FFAB569B4CF31FD0B947C45E1768A2E9DFE8369F520DC38D77937B69B821DB4FFEA8F50EBC404F0587B5598189F54B5A5B98966FD16801C87DE2C3C7813DD70DC600824D426D88C55E89D47214D59206A7A65A65DA7CA2E42FA62ED17E7AA5B3ED446BCC71F17FEC8593BE96D2037BD07F9476D4D732B32BC5DF8C921316B45699004716FC89F8D45BAE402C26DBCDF1A340847B932FF882DBEAFBEDD252E126C89A1E1FDD8908A1F67D15D8E432DAD8E08E950A3BC46B96CB89CC5BDAC703B3FA3E986EF1C6E7E6606E6845BA1EB2FBDCFEE744B5E45206F4A419E1CB103C8490EB293EE9AEC1F0A0D294F9D3847737413D30873F3C94740E8FD072817815EBBCE3F09EDEC9D1211A9E99547D620B2EC56C89E9CB8144AE9E46636324BD13C6CCA3AB9CD9FD8F7F937ABABC598232384427A2D4CE0CBF9765F7225E208C3CE128602B0AD08A1BAAB77EDB3111F0C6CA7BA0EAC9D89D5B4378EB82C17F6EA08308A79A53D150D3F85EFAB77294F02EE0E2885EE2AB2793392B87DB11FA77992F5B4FD75EF2F1A822E87407A4878894215AB89B6CC4A120F5A78B3C31AB80FFCC9ACEF53FC6F7F85685EB9D56D30D87C21ABBF1652EEF8F32C7C567BD1F08623B09C29F33561D42727A5649A3850071AA6C11735AE63C4FD31559CE560B27A362786A83353FE460B37074664A9421D3B2F6A864D5ACA087187B27E2B82F31CB3DF5E985CEA271C609B94B4E58356D40C7D5C7FF2E5990FB39588154843EA5FCA92F120075D4C4D006661A0FA1B0585454BEA725473EEF7D58117D5840C8348999003736C5EEB7858FFD273A1C3EB2812F5697C59110275B08F6BEFBE84C92497D5F73B7B6F794A849713B23AC5F29D5C7112FB2E7A6E89EB54DDFA3122E6C79624C1BF25EBFB9FE5CE6DAA779F3ECB2984DA42F8C6ADC77B21DD291E684FCA50E46070962A2D4F00813D8DE1B8ED33FED9715180C7EA8E2BB74FA65D9C7F6E142F3C81CDC59172E1020F62F65CA5A12CF2BED9DEA04A4D8CABC2948F7BE823A3E792625275B3925A6C8D8E2B428C75A5DB0F7120278CD7D6CAB768755C7FE2FBF89FDED1FB38AC7F76A2F8798CA36ED42CB7C07F006271205F546A4812C20077F050D4CDC79459FA686E97F0704B7A9FF7DE16318E862C53D361BC635A55A264BE15016545DBFCE3C6D6849576ADEFB6884EDD768214E0B438B0231B4F2692C2C0B5C177674F8A0DE236EACD9E0CEC7C8647E4E9A5861B957EC834A2F8572F01304C3FD6A06019E5F1499B62BAA8670B652467FA9A4F10F053263BFE9743CC7D933F86136AAE3A6FB56754D7D238397A0030CEBEA87CB255AF36138C373DBBAC41DD4A697032E4796C552AD9C9B3FA713C3A4E09E0EC5581E94BE7F31065157662F9E9C678B1EF1B8B8A847C51789C22B1841BCFC855820AF3258AF9E08231090B45D10046A00178E89BD515616B8A44E77BF57795DABAF40687B2CDA7A5014168F) == md 0x978A5C74CAB4D5B773ADF64CABEC0DE036D087E041F6C1A985530C2250D283FAAA7FFAA0142588694E67245BBA56B9C8;


// utility functions

md : {x} (fin x) => [8*x] -> [8*x];
md x = join(reverse(groupBy(8, x)));

r : {n x}
  ( fin n, fin x
  , n >= n%8
  , 8*((n+7)/8) >= n%8
  , n%8-8*((n+7)/8)+8*x >= 0
  , n%8-8*((n+7)/8)+8*x >= max(n%8-8*((n+7)/8),0)
  , 8*x-8*((n+7)/8) == 0
  , n%8-n+8*x >= max(n%8-n,0)
  ) => [8 * x] -> [n];
r X = h # t
  where {
    M = md X;
    h = take(`n - `n % 8, M);
    t = drop(8 * ((`n + 7) / 8) - `n % 8, M);
  };
